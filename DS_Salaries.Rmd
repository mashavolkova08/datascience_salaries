---
title: "Data Science Salaries Project"
output:
  pdf_document: default
  html_document: default
date: "2023-04-17"
author: "Aditi Patil and Masha Volkova"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Aditi Patil and Masha Volkova 

```{r}
ds.salaries <- read.csv(file = 'ds_salaries.csv')
str(ds.salaries)
```

## Preprocessing and Exploratory Analysis
Since `salaries` is in different currencies we can drop it for in favor of `salary_in_usd`. Furthermore we can also drop variables like `X`, `company_location`, `employee_residence`, and `salary_currency`
```{r}
cols = c("work_year","experience_level","employment_type","salary_in_usd")
ds.salaries = subset(ds.salaries,select=cols)

# Treat the char variables as factors
ds.salaries$work_year = as.factor(ds.salaries$work_year)
ds.salaries$experience_level = as.factor(ds.salaries$experience_level)
ds.salaries$employment_type = as.factor(ds.salaries$employment_type)

# View the final data
str(ds.salaries)
```
work_year,experience_level, employment_type 3- fixed effect, 1 year and


```{r, fig.height = 4, fig.width = 8}
boxplot(ds.salaries$salary_in_usd, xlab="salaries")
boxplot(salary_in_usd~employment_type,
        data=ds.salaries)
boxplot(salary_in_usd~experience_level,
        data=ds.salaries)
boxplot(salary_in_usd~work_year,
        data=ds.salaries)
```
 

## ANOVA Assumptions
```{r}
lm.salaries = lm(salary_in_usd~ work_year + experience_level + employment_type, data = ds.salaries)

lm.log.salaries = lm(log(salary_in_usd)~ work_year + experience_level + employment_type, data = ds.salaries)

lm.sqrt.salaries = lm(sqrt(salary_in_usd)~ work_year + experience_level + employment_type, data = ds.salaries)

plot(lm.salaries,which=c(1,2))
plot(lm.log.salaries,which=c(1,2))
plot(lm.sqrt.salaries,which=c(1,2))

```

## Fixed effect model
```{r}
library(car)
model.1 = lm(salary_in_usd ~work_year+ experience_level+employment_type,data=ds.salaries)
fixed.1 = aov(model.1)
summary(fixed.1)
```
```{r}
model.2 = lm(salary_in_usd ~work_year*experience_level*employment_type,data=ds.salaries)
fixed.2 = aov(model.2)
summary(fixed.2)
```
Since the highest level interaction term was not significant we can drop it and consider the two way interactions
```{r}
model.3 = lm(salary_in_usd ~work_year+experience_level+employment_type +
                     work_year:experience_level + work_year:employment_type + 
                     experience_level:employment_type,data=ds.salaries)
fixed.3 = aov(model.3)
summary(fixed.3)
```
We can compare models `fixed.1` and `fixed.3` where `fixed.1` is the null model and `fixed.3` is the alternative model
```{r}
anova(model.1,model.3)
```
In this case the interaction effect is  significant, so we will consider `model.3` as the final fixed effects model

## Random Effects
Since we picked the model without interactions, we will now consider if `work_year` can be treated as a random effect. The study only pulled data from `2020`,`2021`,and `2022` so we can say that the levels represent a random sample from all the years.
```{r}
library(lme4)
mixed.1 = lmer(salary_in_usd ~experience_level+employment_type+ (1|work_year), data =ds.salaries)
summary(mixed.1)
```
```{r}
mixed.2 = lmer(salary_in_usd ~experience_level*employment_type+ (1|work_year), data =ds.salaries)
summary(mixed.2)
```

```{r}
anova(mixed.1,mixed.2)
```


